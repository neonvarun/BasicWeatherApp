<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Weather Forecast</title>
    <meta name="description" content="Modern Weather Forecast Application">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <div class="card">
            <div class="header">
                <div class="header-top">
                    <h1>Weather Forecast</h1>
                    <button class="temp-toggle" title="Toggle ¬∞C/¬∞F">
                        <span class="toggle-indicator">¬∞C</span>
                    </button>
                </div>
                <p class="subtitle">Get weather updates instantly</p>
            </div>

            <div class="search-container">
                <div class="search">
                    <input type="text" placeholder="Search for a city..." spellcheck="false" class="search-input">
                    <button class="search-btn" title="Search"><img src="images/search.png" alt="Search"></button>
                    <button class="location-btn" title="Use current location">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="error-message">
                <p>‚ö†Ô∏è Invalid city name. Please try again.</p>
            </div>

            <div class="weather-info">
                <div class="weather-main">
                    <img src="images/rain.png" class="weather-icon" alt="Weather">
                    <div class="temp-section">
                        <h1 class="temp">22¬∞C</h1>
                        <h2 class="city">New York</h2>
                        <p class="location-info">Location found</p>
                    </div>
                </div>

                <div class="weather-description">
                    <p class="description">Rainy</p>
                </div>

                <div class="details">
                    <div class="detail-card">
                        <div class="detail-icon">
                            <img src="images/humidity.png" alt="Humidity">
                        </div>
                        <div class="detail-content">
                            <p class="detail-value humidity">50%</p>
                            <p class="detail-label">Humidity</p>
                        </div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-icon">
                            <img src="images/wind.png" alt="Wind">
                        </div>
                        <div class="detail-content">
                            <p class="detail-value wind">15 km/h</p>
                            <p class="detail-label">Wind Speed</p>
                        </div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-icon">
                            üå°Ô∏è
                        </div>
                        <div class="detail-content">
                            <p class="detail-value feels-like">20¬∞C</p>
                            <p class="detail-label">Feels Like</p>
                        </div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-icon">
                            üß≠
                        </div>
                        <div class="detail-content">
                            <p class="detail-value pressure">1013 mb</p>
                            <p class="detail-label">Pressure</p>
                        </div>
                    </div>
                </div>

                <div class="additional-info">
                    <div class="info-row">
                        <div class="info-item">
                            <span class="info-label">üåÖ Sunrise</span>
                            <span class="info-value sunrise">6:30 AM</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">üåá Sunset</span>
                            <span class="info-value sunset">6:30 PM</span>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-item">
                            <span class="info-label">üëÅÔ∏è Visibility</span>
                            <span class="info-value visibility">10 km</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">üí® Feels Like Wind</span>
                            <span class="info-value wind-chill">18¬∞C</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="recent-searches">
                <p class="recent-title">Recent Searches</p>
                <div class="search-history"></div>
            </div>
        </div>
    </div>
    <script>
        const apiKey = "ce0fa35846c5a6e6791439dda93a5675";
        const apiUrl = "https://api.openweathermap.org/data/2.5/weather?units=metric&q=";

        const searchBox = document.querySelector(".search-input");
        const searchBtn = document.querySelector(".search-btn");
        const locationBtn = document.querySelector(".location-btn");
        const tempToggleBtn = document.querySelector(".temp-toggle");
        const weatherIcon = document.querySelector(".weather-icon");
        const errorMessage = document.querySelector(".error-message");
        const weatherInfo = document.querySelector(".weather-info");
        const searchHistory = document.querySelector(".search-history");

        let isCelsius = true;
        let currentWeatherData = null;

        // Temperature conversion
        function convertTemp(celsius) {
            return isCelsius ? celsius : Math.round((celsius * 9/5) + 32);
        }

        function getUnitSymbol() {
            return isCelsius ? "¬∞C" : "¬∞F";
        }

        // Temperature toggle
        tempToggleBtn.addEventListener("click", () => {
            isCelsius = !isCelsius;
            tempToggleBtn.querySelector(".toggle-indicator").textContent = getUnitSymbol();
            if (currentWeatherData) {
                updateWeatherDisplay();
            }
        });

        // Get current location
        locationBtn.addEventListener("click", () => {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        fetchWeatherByCoords(lat, lon);
                    },
                    (error) => {
                        errorMessage.innerHTML = "<p>‚ö†Ô∏è Unable to get your location</p>";
                        errorMessage.style.display = "block";
                        console.error(error);
                    }
                );
            }
        });

        async function fetchWeatherByCoords(lat, lon) {
            try {
                const response = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`
                );
                if (response.ok) {
                    currentWeatherData = await response.json();
                    updateWeatherDisplay();
                    saveSearch(currentWeatherData.name);
                }
            } catch (error) {
                console.error("Error fetching weather by coordinates:", error);
            }
        }

        async function checkWeather(city) {
            try {
                const response = await fetch(apiUrl + city + `&appid=${apiKey}`);

                if (response.status === 404) {
                    errorMessage.style.display = "block";
                    weatherInfo.style.display = "none";
                } else if (response.ok) {
                    currentWeatherData = await response.json();
                    updateWeatherDisplay();
                    saveSearch(city);
                }
            } catch (error) {
                console.error("Error fetching weather:", error);
                errorMessage.style.display = "block";
                weatherInfo.style.display = "none";
            }
        }

        function updateWeatherDisplay() {
            const data = currentWeatherData;

            document.querySelector(".city").innerHTML = data.name + ", " + data.sys.country;
            document.querySelector(".temp").innerHTML = convertTemp(data.main.temp) + getUnitSymbol();
            document.querySelector(".feels-like").innerHTML = convertTemp(data.main.feels_like) + getUnitSymbol();
            document.querySelector(".humidity").innerHTML = data.main.humidity + "%";
            document.querySelector(".wind").innerHTML = Math.round(data.wind.speed) + " km/h";
            document.querySelector(".pressure").innerHTML = data.main.pressure + " mb";
            document.querySelector(".description").innerHTML = data.weather[0].main;
            document.querySelector(".visibility").innerHTML = (data.visibility / 1000).toFixed(1) + " km";

            // Wind chill calculation (simplified)
            const windChill = (data.main.feels_like - (data.main.temp - data.main.feels_like)).toFixed(0);
            document.querySelector(".wind-chill").innerHTML = convertTemp(parseInt(windChill)) + getUnitSymbol();

            // Sunrise and Sunset
            const sunrise = new Date(data.sys.sunrise * 1000);
            const sunset = new Date(data.sys.sunset * 1000);
            document.querySelector(".sunrise").innerHTML = sunrise.toLocaleTimeString('en-US', {hour: '2-digit', minute:'2-digit'});
            document.querySelector(".sunset").innerHTML = sunset.toLocaleTimeString('en-US', {hour: '2-digit', minute:'2-digit'});

            // Weather icon
            const weatherMain = data.weather[0].main;
            let iconSrc = "images/rain.png";
            if (weatherMain === "Clouds") {
                iconSrc = "images/clouds.png";
            } else if (weatherMain === "Clear") {
                iconSrc = "images/clear.png";
            } else if (weatherMain === "Rain") {
                iconSrc = "images/rain.png";
            } else if (weatherMain === "Drizzle") {
                iconSrc = "images/drizzle.png";
            } else if (weatherMain === "Mist" || weatherMain === "Fog") {
                iconSrc = "images/mist.png";
            } else if (weatherMain === "Snow") {
                iconSrc = "images/snow.png";
            }
            weatherIcon.src = iconSrc;

            weatherInfo.style.display = "block";
            errorMessage.style.display = "none";
        }

        // Search history
        function saveSearch(city) {
            let searches = JSON.parse(localStorage.getItem("weatherSearches")) || [];
            searches = searches.filter(s => s.toLowerCase() !== city.toLowerCase());
            searches.unshift(city);
            searches = searches.slice(0, 5);
            localStorage.setItem("weatherSearches", JSON.stringify(searches));
            displaySearchHistory();
        }

        function displaySearchHistory() {
            const searches = JSON.parse(localStorage.getItem("weatherSearches")) || [];
            searchHistory.innerHTML = "";
            searches.forEach(city => {
                const tag = document.createElement("span");
                tag.className = "search-tag";
                tag.textContent = city;
                tag.addEventListener("click", () => {
                    checkWeather(city);
                    searchBox.value = city;
                });
                searchHistory.appendChild(tag);
            });
        }

        // Event listeners
        searchBtn.addEventListener("click", () => {
            if (searchBox.value.trim()) {
                checkWeather(searchBox.value);
            }
        });

        searchBox.addEventListener("keypress", (e) => {
            if (e.key === "Enter" && searchBox.value.trim()) {
                checkWeather(searchBox.value);
            }
        });

        // Initial display
        displaySearchHistory();
        checkWeather("London");
    </script>
</body>

</html>



<!-- https://api.openweathermap.org/data/2.5/weather?q=germany&appid=ce0fa35846c5a6e6791439dda93a5675&units=metric -->